---
title: "[Spring] 스프링 컨테이너와 스프링 빈 정리"
excerpt: "IOC, Bean"

categories:
  - Spring
tags:
  - [java]

permalink: /spring/spring-1/

toc: true
toc_sticky: true

date: 2023-03-26
last_modified_at: 2023-03-26
---

> 영한님의 스프링 핵심 원리를 보고 정리한 글입니다.

- [출처](https://www.inflearn.com/course/%EC%8A%A4%ED%94%84%EB%A7%81-%ED%95%B5%EC%8B%AC-%EC%9B%90%EB%A6%AC-%EA%B8%B0%EB%B3%B8%ED%8E%B8/dashboard)
- [저작권](https://www.inflearn.com/questions/261475/%EA%B0%9C%EC%9D%B8-%EA%B0%9C%EB%B0%9C-%EB%B8%94%EB%A1%9C%EA%B7%B8%EC%97%90-%EA%B0%95%EC%9D%98-%EB%82%B4%EC%9A%A9%EC%9D%84-%EC%A0%95%EB%A6%AC%ED%95%98%EB%8A%94-%EA%B2%83%EA%B3%BC-%EA%B4%80%EB%A0%A8%EB%90%9C-%EB%AC%B8%EC%9D%98%EA%B0%80-%EC%9E%88%EC%8A%B5%EB%8B%88%EB%8B%A4)

## 스프링 컨테이너 생성

```java
ApplicaitonContext applicationContext = new AnnotationConfigApplicationContext(AppConfig.class);
```

- `ApplicationContext`를 스프링 컨테이너라고 하고, 이는 인터페이스이다.
- [AppConfig](#appconfig) 방식 -> 스프링 컨테이너
- `AnnotationConfigApplicationContext`
  - 이 클래스는 `Applicationcontext` 인터페이스의 구현체이다.

## AppConfig

- AppConfig 방식 적용 전

```java
public class OrderServiceImpl implements OrderService {
    private final MemberRepository memberRepository = new MemoryMemberRepository();
    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
}
```

- 인터페이스도 참조, 구현체도 참조하는 코드
  - DIP 위반
- `DiscountPolicy`의 구현체를 변경하면 단순하게 코드만 변경하게 됨
  - 이는 OCP 위반

<br>

- 적용 후

```java
public class AppConfig {
    public MemberService memberService(){
        return new MemberServiceImpl(new MemoryMemberRepository());
    }

    public OrderService orderService(){
        return new OrderServiceImpl(new MemoryMemberRepository(), new FixDiscountPolicy());
    }
}
```
- DIP, OCP를 위반하지 않게 하는 것이 AppConfig 방식
  - 이는 애플리케이션의 전체 구성을 책임지며, 생성자 주입을 하게 됨
- 이 방식을 사용하면 Impl 클래스에서 참조가 필요 없어짐
- 오직 "추상적"으로만 의존
- AppConfig는 어떤 구현 객체를 주입할지 설정을 해주고
  - Impl은 "추상적"으로 참조하면서 의존관계에 대한 고민은 외부에 맡기고 실행해만 집중하면 됨

## 스프링 컨테이너의 생성 과정

1. 스프링 컨테이너 생성
  -  스프링 빈 구성 정보 지정
2. 스프링 빈 등록
  - 스프링 컨테이너 내부의 진 저장소는 일종의 key, value로 이루어져 있음
  - 설정파일의 메서드 이름과 반환 객체를 가지고 각각 key, value로 객체를 저장소에 저장
3. 스프링 빈 의존관계 설정 (준비, 완료)
  - 원래, 스프링 빈들을 다 생성 후 의존 관계를 주입하고 단계가 나누어져 있음
  - 하지만 자바 설정 파일로 한 경우
    - 빈 등록 시 생성자가 호출되며 해당 생성자 인자를 가지고 의존 관계 주입도 같이 이루어짐
  - (주의!) 빈 이름은 항상 다른 이름으로 설정
    - 빈의 이름이 중복되면 다른 빈이 무시되거나 덮어 씌울 수 있음

> 아래는 제공된 pdf의 그림입니다.



## 컨테이너에 등록된 모든 빈 조회

